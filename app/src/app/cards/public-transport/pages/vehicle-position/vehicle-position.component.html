<ion-header>
  <ion-toolbar>
    <ion-back-button slot="start" defaultHref="/"></ion-back-button>
    <ion-title>Poloha vozu</ion-title>
  </ion-toolbar>
</ion-header>
<pd-map [autoCenter]="true" [poi]="false">
  <!-- stop -->
  <pd-map-marker *ngIf="targetPlatform" [coords]="[targetPlatform.lon, targetPlatform.lat]" icon="🚏"></pd-map-marker>

  <!-- vehicle -->
  <pd-map-marker
    *ngIf="vehiclePosition"
    [coords]="vehiclePosition.geometry.coordinates"
    [pointer]="true"
    [icon]="routeType?.icon"
    [iconDirection]="routeType?.iconDirection"
    [bearing]="vehiclePosition.properties.last_position.bearing"
  ></pd-map-marker>
</pd-map>

<ion-footer *ngIf="vehiclePosition" class="ion-padding">
  <h3>
    {{ routeType?.icon }}
    {{ vehiclePosition.properties.trip.gtfs.route_short_name }}
    ➡️ {{ vehiclePosition.properties.trip.gtfs.trip_headsign }}
  </h3>
  <table>
    <tr>
      <th>Aktuální zastávka</th>
      <th class="delay">Zpoždění</th>
    </tr>
    <tr>
      <td>{{ lastPlatform?.stop?.name }}</td>
      <td class="delay">{{ formatDelay(vehiclePosition.properties.last_position.delay.actual) }}</td>
    </tr>
    <tr>
      <th>Příští zastávka</th>
    </tr>
    <tr>
      <td>{{ nextPlatform?.stop?.name }}</td>
    </tr>
  </table>
</ion-footer>
