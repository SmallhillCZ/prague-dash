"use strict";(self.webpackChunkprague_dash=self.webpackChunkprague_dash||[]).push([[8898],{8898:(K,Z,d)=>{d.r(Z),d.d(Z,{DashModule:()=>j});var h=d(8583),y=d(7297),D=d(4466),g=d(6270),b=d(4762),_=d(3728),p=d(9794),t=d(639),l=d(8239),S=d(6215);class A{constructor(){this.cards=[]}}var x=d(9672);let v=(()=>{class e{constructor(n,o){this.storage=n,this.cardTypes=o,this.dashboard=new S.X(void 0),this.loadDashboard()}getDashboard(){var n=this;return(0,l.Z)(function*(){const o=yield n.storage.get("dashboard");return Object.assign(new A,o)})()}loadDashboard(){var n=this;return(0,l.Z)(function*(){let o=yield n.getDashboard();o=n.fixDash(o),n.dashboard.next(o)})()}saveDashboard(n){var o=this;return(0,l.Z)(function*(){return n=o.fixDash(n),yield o.storage.set("dashboard",n),o.loadDashboard()})()}createCard(n,o){var r=this;return(0,l.Z)(function*(){const i=yield r.getDashboard(),u={id:String(i.cards.reduce((L,V)=>Math.max(L,Number(V.id)),0)+1),type:n,color:"white",definition:o};return null==i||i.cards.push(u),r.saveDashboard(i)})()}updateCard(n){var o=this;return(0,l.Z)(function*(){n=JSON.parse(JSON.stringify(n));const r=yield o.getDashboard(),i=r.cards.findIndex(c=>c.id===n.id);-1===i?r.cards.push(n):r.cards.splice(i,1,n),o.saveDashboard(r)})()}removeCard(n){var o=this;return(0,l.Z)(function*(){const r=yield o.getDashboard(),i=r.cards.findIndex(c=>c.id===n);r.cards.splice(i,1),o.saveDashboard(r)})()}fixDash(n){return n.cards=n.cards.filter(o=>this.cardTypes.some(r=>r.type===o.type)),n}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(x.V),t.LFG(p.g))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var s=d(3083);let O=(()=>{class e{constructor(n,o,r){this.componentFactoryResolver=n,this.viewContainerRef=o,this.cards=r}ngOnInit(){}ngOnChanges(){this.renderCard(this.card)}renderCard(n){const o=this.cards.find(c=>c.type===n.type);if(!o)return;this.viewContainerRef.clear();const r=this.componentFactoryResolver.resolveComponentFactory(o.component);this.viewContainerRef.createComponent(r).instance.card=n}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(t._Vd),t.Y36(t.s_b),t.Y36(p.g))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-card-content"]],inputs:{card:"card"},features:[t.TTD],decls:0,vars:0,template:function(n,o){},styles:[""],changeDetection:0}),e})(),F=(()=>{class e{constructor(){this.classes={}}ngOnInit(){}ngOnChanges(){this.classes={},this.card.color&&(this.classes["color-"+this.card.color]=!0)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-dash-card"]],inputs:{card:"card"},features:[t.TTD],decls:2,vars:2,consts:[["mode","ios",3,"ngClass"],[3,"card"]],template:function(n,o){1&n&&(t.TgZ(0,"ion-card",0),t._UZ(1,"app-card-content",1),t.qZA()),2&n&&(t.Q6J("ngClass",o.classes),t.xp6(1),t.Q6J("card",o.card))},directives:[s.PM,h.mk,O],styles:["@supports ((-webkit-backdrop-filter: none) or (backdrop-filter: none)){ion-card[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background-color:#ffffffb3}}ion-card.color-pink[_ngcontent-%COMP%]{background-color:#f8607cb3;color:#111}ion-card.color-black[_ngcontent-%COMP%]{background-color:#000000b3;color:#eee}ion-card.color-black[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#ddd}ion-card.color-blue[_ngcontent-%COMP%]{background-color:#1889f3b3;color:#eee}ion-card.color-blue[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#ddd}"]}),e})();function q(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"app-dash-card",9),t.NdJ("click",function(){const i=t.CHM(n).$implicit;return t.oxw().openDetail(i)}),t.qZA()}2&e&&t.Q6J("card",a.$implicit)}let m=class{constructor(a,n,o){this.dashboardService=a,this.cardTypes=n,this.navController=o,this.cards=[]}ngOnInit(){this.dashboardService.dashboard.pipe((0,_.t)(this)).subscribe(a=>this.cards=(null==a?void 0:a.cards)||[])}doRefresh(a){this.cards=JSON.parse(JSON.stringify(this.cards)),setTimeout(()=>{var n;null===(n=a.target)||void 0===n||n.complete()},500)}openDetail(a){const n=this.cardTypes.find(o=>o.type===a.type);!n||this.navController.navigateForward(n.detailComponent?"/card/"+a.id:"/card/"+a.id+"/settings")}};function Y(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"ion-item",3),t.NdJ("click",function(){const i=t.CHM(n).$implicit;return t.oxw().onSelect(i)}),t.TgZ(1,"ion-label"),t._uU(2),t.qZA(),t.qZA()}if(2&e){const n=a.$implicit;t.xp6(2),t.Oqu(n.title.cs)}}m.\u0275fac=function(a){return new(a||m)(t.Y36(v),t.Y36(p.g),t.Y36(s.SH))},m.\u0275cmp=t.Xpm({type:m,selectors:[["app-dash"]],decls:13,vars:1,consts:[[1,"ion-no-border"],["color","light"],["slot","primary"],["routerLink","/dash/add","color","light"],["name","add-outline"],["color","light","routerLink","/settings"],["name","settings-outline"],["slot","fixed",3,"ionRefresh"],[3,"card","click",4,"ngFor","ngForOf"],[3,"card","click"]],template:function(a,n){1&a&&(t.TgZ(0,"ion-header",0),t.TgZ(1,"ion-toolbar"),t.TgZ(2,"ion-title",1),t._uU(3," PragueDash "),t.qZA(),t.TgZ(4,"ion-buttons",2),t.TgZ(5,"ion-button",3),t._UZ(6,"ion-icon",4),t.qZA(),t.TgZ(7,"ion-button",5),t._UZ(8,"ion-icon",6),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"ion-content"),t.TgZ(10,"ion-refresher",7),t.NdJ("ionRefresh",function(r){return n.doRefresh(r)}),t._UZ(11,"ion-refresher-content"),t.qZA(),t.YNc(12,q,1,1,"app-dash-card",8),t.qZA()),2&a&&(t.xp6(12),t.Q6J("ngForOf",n.cards))},directives:[s.Gu,s.sr,s.wd,s.Sm,s.YG,g.rH,s.YI,s.gu,s.W2,s.nJ,s.Wo,h.sg,F],styles:["ion-content[_ngcontent-%COMP%], ion-toolbar[_ngcontent-%COMP%]{--background: transparent}ion-slides[_ngcontent-%COMP%]{height:100%}ion-slide[_ngcontent-%COMP%]{flex-direction:column;justify-content:flex-start;text-align:left}[_nghost-%COMP%]{background-image:url(/demo/bg.20dac99ae39052c6331d.jpg);background-size:cover;background-position:center}"]}),m=(0,b.gn)([(0,_.c)()],m);let w=(()=>{class e{constructor(n,o,r){this.navController=n,this.dashboard=o,this.cards=r}ngOnInit(){}onSelect(n){n.selectComponent?this.navController.navigateForward("/dash/add/"+n.type):(this.dashboard.createCard(n.type,n.defaultDefinition||{}),this.navController.navigateForward("/"))}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(s.SH),t.Y36(v),t.Y36(p.g))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-dash-card-add"]],decls:9,vars:1,consts:[["slot","start"],["defaultHref","/"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(n,o){1&n&&(t.TgZ(0,"ion-header"),t.TgZ(1,"ion-toolbar"),t.TgZ(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5,"P\u0159idat kartu"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(6,"ion-content"),t.TgZ(7,"ion-list"),t.YNc(8,Y,3,1,"ion-item",2),t.qZA(),t.qZA()),2&n&&(t.xp6(8),t.Q6J("ngForOf",o.cards))},directives:[s.Gu,s.sr,s.Sm,s.oU,s.cs,s.wd,s.W2,s.q_,h.sg,s.Ie,s.Q$],styles:[""]}),e})();var M=d(739),k=d(8002),J=d(5435);let R=(()=>{class e{constructor(n,o,r){this.componentFactoryResolver=n,this.viewContainerRef=o,this.cards=r}ngOnInit(){}ngOnChanges(){this.renderCard(this.card)}renderCard(n){const o=this.cards.find(c=>c.type===n.type);if(!o||!o.detailComponent)return;this.viewContainerRef.clear();const r=this.componentFactoryResolver.resolveComponentFactory(o.detailComponent);this.viewContainerRef.createComponent(r).instance.card=n}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(t._Vd),t.Y36(t.s_b),t.Y36(p.g))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-card-detail-content"]],inputs:{card:"card"},features:[t.TTD],decls:0,vars:0,template:function(n,o){},styles:[""]}),e})();function U(e,a){1&e&&(t.TgZ(0,"ion-button",5),t._UZ(1,"ion-icon",6),t.qZA())}function I(e,a){if(1&e&&t._UZ(0,"app-card-detail-content",7),2&e){const n=t.oxw();t.Q6J("card",n.card)}}let N=(()=>{class e{constructor(n,o,r){this.route=n,this.dashboardService=o,this.cardTypes=r}ngOnInit(){const n=this.route.params.pipe((0,k.U)(r=>r.id));(0,M.aj)([n,this.dashboardService.dashboard]).pipe((0,J.h)(r=>!!r[1])).subscribe(([r,i])=>this.loadCard(r,i))}loadCard(n,o){var r=this;return(0,l.Z)(function*(){r.card=null==o?void 0:o.cards.find(i=>i.id===n),r.cardType=r.cardTypes.find(i=>{var c;return i.type===(null===(c=r.card)||void 0===c?void 0:c.type)})})()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(g.gz),t.Y36(v),t.Y36(p.g))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-dash-card-detail"]],decls:10,vars:3,consts:[["slot","start"],["defaultHref","/"],["slot","end"],["routerLink","settings",4,"ngIf"],[3,"card",4,"ngIf"],["routerLink","settings"],["name","settings-outline"],[3,"card"]],template:function(n,o){1&n&&(t.TgZ(0,"ion-header"),t.TgZ(1,"ion-toolbar"),t.TgZ(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.qZA(),t.TgZ(6,"ion-buttons",2),t.YNc(7,U,2,0,"ion-button",3),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"ion-content"),t.YNc(9,I,1,1,"app-card-detail-content",4),t.qZA()),2&n&&(t.xp6(5),t.Oqu((null==o.cardType||null==o.cardType.title?null:o.cardType.title.cs)||"Detail karty"),t.xp6(2),t.Q6J("ngIf",null==o.cardType?null:o.cardType.settingsComponent),t.xp6(2),t.Q6J("ngIf",o.card))},directives:[s.Gu,s.sr,s.Sm,s.oU,s.cs,s.wd,h.O5,s.W2,s.YG,g.rH,s.YI,s.gu,R],styles:[""]}),e})(),Q=(()=>{class e{constructor(n,o){this.componentFactoryResolver=n,this.viewContainerRef=o,this.select=new t.vpe,this.buttons=new t.vpe}ngOnInit(){}ngOnChanges(){this.removeOldComponent(),this.cardType&&this.renderComponent(this.cardType)}renderComponent(n){var o,r;if(!(null===(o=this.cardType)||void 0===o?void 0:o.selectComponent))return;const i=this.componentFactoryResolver.resolveComponentFactory(n.selectComponent),c=this.viewContainerRef.createComponent(i);this.selectSubscription=c.instance.select.subscribe(u=>this.select.emit(u)),this.buttonsSubscription=null===(r=c.instance.buttons)||void 0===r?void 0:r.subscribe(u=>this.buttons.emit(u))}removeOldComponent(){var n,o;null===(n=this.selectSubscription)||void 0===n||n.unsubscribe(),null===(o=this.buttonsSubscription)||void 0===o||o.unsubscribe(),this.viewContainerRef.clear()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(t._Vd),t.Y36(t.s_b))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-card-selection-content"]],inputs:{cardType:"cardType"},outputs:{select:"select",buttons:"buttons"},features:[t.TTD],decls:0,vars:0,template:function(n,o){},styles:[""]}),e})();function P(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"ion-button",6),t.NdJ("click",function(){return t.CHM(n).$implicit.handler()}),t._UZ(1,"ion-icon",7),t.qZA()}if(2&e){const n=a.$implicit;t.xp6(1),t.Q6J("name",n.icon)}}function E(e,a){if(1&e&&(t.TgZ(0,"ion-buttons",4),t.YNc(1,P,2,1,"ion-button",5),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.buttons)}}let C=class{constructor(a,n,o,r){this.route=a,this.dashboardService=n,this.navController=o,this.cards=r}ngOnInit(){}ionViewWillEnter(){this.route.params.pipe((0,_.t)(this)).subscribe(a=>{this.buttons=void 0,this.cardType=this.cards.find(n=>n.type===a.id)})}createCard(a){var n=this;return(0,l.Z)(function*(){!n.cardType||(yield n.dashboardService.createCard(n.cardType.type,a),n.navController.navigateRoot("/"))})()}};C.\u0275fac=function(a){return new(a||C)(t.Y36(g.gz),t.Y36(v),t.Y36(s.SH),t.Y36(p.g))},C.\u0275cmp=t.Xpm({type:C,selectors:[["app-dash-card-selection"]],decls:9,vars:3,consts:[["slot","start"],["defaultHref","/dash/add"],["slot","end",4,"ngIf"],[3,"cardType","buttons","select"],["slot","end"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[3,"name"]],template:function(a,n){1&a&&(t.TgZ(0,"ion-header"),t.TgZ(1,"ion-toolbar"),t.TgZ(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.qZA(),t.YNc(6,E,2,1,"ion-buttons",2),t.qZA(),t.qZA(),t.TgZ(7,"ion-content"),t.TgZ(8,"app-card-selection-content",3),t.NdJ("buttons",function(r){return n.buttons=r})("select",function(r){return n.createCard(r)}),t.qZA(),t.qZA()),2&a&&(t.xp6(5),t.Oqu(null==n.cardType||null==n.cardType.title?null:n.cardType.title.cs),t.xp6(1),t.Q6J("ngIf",n.buttons),t.xp6(2),t.Q6J("cardType",n.cardType))},directives:[s.Gu,s.sr,s.Sm,s.oU,s.cs,s.wd,h.O5,s.W2,Q,h.sg,s.YG,s.gu],styles:[""]}),C=(0,b.gn)([(0,_.c)()],C);let H=(()=>{class e{constructor(n,o,r){this.componentFactoryResolver=n,this.viewContainerRef=o,this.cards=r,this.change=new t.vpe}ngOnInit(){}ngOnChanges(){this.renderCard(this.card)}renderCard(n){var o;const r=this.cards.find(u=>u.type===n.type);if(!r||!r.settingsComponent)return;this.viewContainerRef.clear(),null===(o=this.changeSubscription)||void 0===o||o.unsubscribe();const i=this.componentFactoryResolver.resolveComponentFactory(r.settingsComponent),c=this.viewContainerRef.createComponent(i);c.instance.card=n,this.changeSubscription=c.instance.change.subscribe(u=>this.change.emit(u))}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(t._Vd),t.Y36(t.s_b),t.Y36(p.g))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-card-custom-settings"]],inputs:{card:"card"},outputs:{change:"change"},features:[t.TTD],decls:0,vars:0,template:function(n,o){},styles:[""]}),e})();var T=d(665);function G(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"app-card-custom-settings",5),t.NdJ("change",function(r){return t.CHM(n),t.oxw(2).saveCustom(r)}),t.qZA()}if(2&e){const n=t.oxw(2);t.Q6J("card",n.card)}}function X(e,a){if(1&e&&(t.ynx(0),t.TgZ(1,"ion-list-header"),t.TgZ(2,"ion-label"),t.TgZ(3,"h1"),t._uU(4),t.qZA(),t.qZA(),t.qZA(),t.YNc(5,G,1,1,"app-card-custom-settings",4),t.BQk()),2&e){const n=t.oxw();t.xp6(4),t.Oqu(n.cardType.title.cs),t.xp6(1),t.Q6J("ngIf",n.card&&n.cardType&&n.cardType.settingsComponent)}}function z(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"ion-item-group"),t.TgZ(1,"ion-item"),t.TgZ(2,"ion-label"),t._uU(3,"Barva"),t.qZA(),t.TgZ(4,"ion-select",6),t.NdJ("ngModelChange",function(r){return t.CHM(n),t.oxw().card.color=r})("ngModelChange",function(){return t.CHM(n),t.oxw().save()}),t.TgZ(5,"ion-select-option",7),t._uU(6,"B\xedl\xe1"),t.qZA(),t.TgZ(7,"ion-select-option",8),t._uU(8,"\u010cern\xe1"),t.qZA(),t.TgZ(9,"ion-select-option",9),t._uU(10,"R\u016f\u017eov\xe1"),t.qZA(),t.TgZ(11,"ion-select-option",10),t._uU(12,"Modr\xe1"),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&e){const n=t.oxw();t.xp6(4),t.Q6J("ngModel",n.card.color)}}function B(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"div",11),t.TgZ(1,"ion-button",12),t.NdJ("click",function(){t.CHM(n);const r=t.oxw();return r.deleteCard(r.card.id)}),t._uU(2,"Smazat kartu"),t.qZA(),t.qZA()}}let f=class{constructor(a,n,o,r){this.route=a,this.navController=n,this.dashboardService=o,this.cards=r}ngOnInit(){}ionViewWillEnter(){this.route.params.pipe((0,_.t)(this)).subscribe(a=>this.loadCard(a.id))}loadCard(a){var n;this.card=null===(n=this.dashboardService.dashboard.value)||void 0===n?void 0:n.cards.find(o=>o.id===a),this.cardType=this.cards.find(o=>{var r;return o.type===(null===(r=this.card)||void 0===r?void 0:r.type)})}deleteCard(a){var n=this;return(0,l.Z)(function*(){yield n.dashboardService.removeCard(a),n.navController.navigateRoot("/")})()}save(){var a=this;return(0,l.Z)(function*(){!a.card||a.dashboardService.updateCard(a.card)})()}saveCustom(a){var n=this;return(0,l.Z)(function*(){!n.card||(n.card.definition=a,n.save())})()}};f.\u0275fac=function(a){return new(a||f)(t.Y36(g.gz),t.Y36(s.SH),t.Y36(v),t.Y36(p.g))},f.\u0275cmp=t.Xpm({type:f,selectors:[["app-dash-card-settings"]],decls:18,vars:3,consts:[["slot","start"],["defaultHref","/"],[4,"ngIf"],["class","actions ion-padding",4,"ngIf"],[3,"card","change",4,"ngIf"],[3,"card","change"],[3,"ngModel","ngModelChange"],["value","white"],["value","black"],["value","pink"],["value","blue"],[1,"actions","ion-padding"],["color","danger",3,"click"]],template:function(a,n){1&a&&(t.TgZ(0,"ion-header"),t.TgZ(1,"ion-toolbar"),t.TgZ(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5,"Nastaven\xed karty"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(6,"ion-content"),t.YNc(7,X,6,2,"ng-container",2),t.TgZ(8,"ion-list-header"),t.TgZ(9,"ion-label"),t.TgZ(10,"h1"),t._uU(11,"Obecn\xe1 nastaven\xed"),t.qZA(),t.qZA(),t.qZA(),t.YNc(12,z,13,1,"ion-item-group",2),t.TgZ(13,"ion-list-header"),t.TgZ(14,"ion-label"),t.TgZ(15,"h1"),t._uU(16,"Smazat kartu"),t.qZA(),t.qZA(),t.qZA(),t.YNc(17,B,3,0,"div",3),t.qZA()),2&a&&(t.xp6(7),t.Q6J("ngIf",n.card&&n.cardType&&n.cardType.settingsComponent),t.xp6(5),t.Q6J("ngIf",n.card),t.xp6(5),t.Q6J("ngIf",n.card))},directives:[s.Gu,s.sr,s.Sm,s.oU,s.cs,s.wd,s.W2,h.O5,s.yh,s.Q$,H,s.Ub,s.Ie,s.t9,s.QI,T.JJ,T.On,s.n0,s.YG],styles:["ion-list-header[_ngcontent-%COMP%]{margin-top:2em}.actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%}"]}),f=(0,b.gn)([(0,_.c)()],f);const W=[{path:"dash",component:m},{path:"dash/add",component:w},{path:"dash/add/:id",component:C},{path:"card/:id",component:N},{path:"card/:id/settings",component:f},{path:"",pathMatch:"full",redirectTo:"dash"}];let $=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[g.Bz.forChild(W)],g.Bz]}),e})(),j=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[h.ez,$,D.m,y.m]]}),e})()}}]);