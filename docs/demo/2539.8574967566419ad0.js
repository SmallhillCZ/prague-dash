"use strict";(self.webpackChunkprague_dash=self.webpackChunkprague_dash||[]).push([[2539],{2539:(Tt,q,l)=>{l.r(q),l.d(q,{DashModule:()=>Zt});var g=l(9808),F=l(7819),J=l(4466),h=l(1576),m=l(9794),t=l(2096),r=l(2974),p=l(5861),S=l(591),Y=l(5523),E=l(7621);let C=(()=>{class i{constructor(e,o){this.storage=e,this.cardTypes=o,this.lang=Y.S.cs,this.dashboard=new S.X(void 0),this.getDashboard().then(a=>{this.dashboard.next(a)})}getDashboard(){var e=this;return(0,p.Z)(function*(){return(yield e.storage.get("dashboard"))||{pages:[{id:"0",title:"Hlavn\xed",cards:[]}]}})()}saveDashboard(e){var o=this;return(0,p.Z)(function*(){yield o.storage.set("dashboard",e),o.dashboard.next(yield o.getDashboard())})()}createPage(e){var o=this;return(0,p.Z)(function*(){const a=yield o.getDashboard();let s=0;for(;a.pages.some(d=>d.id===String(s));)s++;const c={id:String(s),title:e,cards:[]};return a.pages.push(c),yield o.saveDashboard(a),c})()}createCard(e,o,a){var s=this;return(0,p.Z)(function*(){const c=yield s.getDashboard(),d=c.pages.find(w=>w.id===e);if(!d)throw new Error(`Page ${e} not found!`);let u=0;for(;c.pages.some(w=>w.cards.some(bt=>bt.id===String(u)));)u++;const D={id:String(u),type:o,color:"white",title:a.title,definition:a.definition};return d.cards.push(D),s.saveDashboard(c)})()}updateCard(e){var o=this;return(0,p.Z)(function*(){e=JSON.parse(JSON.stringify(e));const a=yield o.getDashboard(),s=a.pages.find(d=>d.cards.some(u=>u.id===e.id));if(!s)throw new Error(`Page for card ${e.id} not found!`);const c=s.cards.findIndex(d=>d.id===e.id);-1===c?s.cards.push(e):s.cards.splice(c,1,e),o.saveDashboard(a)})()}removeCard(e){var o=this;return(0,p.Z)(function*(){const a=yield o.getDashboard(),s=a.pages.find(d=>d.cards.some(u=>u.id===e));if(!s)throw new Error(`Page for card ${e} not found!`);const c=s.cards.findIndex(d=>d.id===e);s.cards.splice(c,1),o.saveDashboard(a)})()}getCard(e){var o=this;return(0,p.Z)(function*(){const a=yield o.getDashboard();for(let s of a.pages)for(let c of s.cards)if(c.id===e)return c})()}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(E.V),t.LFG(m.g))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function I(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",3),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw().onSelect(s)}),t.TgZ(1,"ion-label"),t._uU(2),t.qZA(),t.qZA()}if(2&i){const e=n.$implicit;t.xp6(2),t.Oqu(e.title.cs)}}let U=(()=>{class i{constructor(e,o,a,s){this.navController=e,this.dashboard=o,this.cards=a,this.route=s}ngOnInit(){}onSelect(e){const o=this.route.snapshot.params.page;e.selectComponent?this.navController.navigateForward(`/page/${o}/add/${e.type}`):(this.dashboard.createCard(o,e.type,{definition:e.defaultDefinition||{},title:e.title.cs}),this.navController.navigateForward("/dash",{queryParams:{page:o}}))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(r.SH),t.Y36(C),t.Y36(m.g),t.Y36(h.gz))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-dash-card-add"]],decls:9,vars:1,consts:[["slot","start"],["defaultHref","/"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header"),t.TgZ(1,"ion-toolbar"),t.TgZ(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5,"P\u0159idat kartu"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(6,"ion-content"),t.TgZ(7,"ion-list"),t.YNc(8,I,3,1,"ion-item",2),t.qZA(),t.qZA()),2&e&&(t.xp6(8),t.Q6J("ngForOf",o.cards))},directives:[r.Gu,r.sr,r.Sm,r.oU,r.cs,r.wd,r.W2,r.q_,g.sg,r.Ie,r.Q$],styles:[""]}),i})();var y=l(655),_=l(4498);let N=(()=>{class i{constructor(e,o,a){this.componentFactoryResolver=e,this.viewContainerRef=o,this.cards=a,this.title=new t.vpe}ngOnInit(){}ngOnChanges(){this.renderCard(this.card)}renderCard(e){const o=this.cards.find(c=>c.type===e.type);if(!o||!o.detailComponent)return;this.viewContainerRef.clear();const a=this.componentFactoryResolver.resolveComponentFactory(o.detailComponent),s=this.viewContainerRef.createComponent(a);s.instance.card=e,s.instance.title&&s.instance.title.subscribe(this.title)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t._Vd),t.Y36(t.s_b),t.Y36(m.g))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-card-detail-content"]],inputs:{card:"card"},outputs:{title:"title"},features:[t.TTD],decls:0,vars:0,template:function(e,o){},styles:[""]}),i})();function Q(i,n){1&i&&(t.TgZ(0,"ion-button",5),t._UZ(1,"ion-icon",6),t.qZA())}function R(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"app-card-detail-content",7),t.NdJ("title",function(a){return t.CHM(e),t.oxw().cardTitle=a}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("card",e.card)}}let f=class{constructor(n,e,o){this.route=n,this.dashboardService=e,this.cardTypes=o}ngOnInit(){this.route.params.pipe((0,_.t)(this)).subscribe(e=>this.loadCard(e.id))}loadCard(n){var e=this;return(0,p.Z)(function*(){var o;e.card=yield e.dashboardService.getCard(n),e.cardType=e.cardTypes.find(a=>{var s;return a.type===(null===(s=e.card)||void 0===s?void 0:s.type)}),e.cardTitle=null===(o=e.card)||void 0===o?void 0:o.title})()}};f.\u0275fac=function(n){return new(n||f)(t.Y36(h.gz),t.Y36(C),t.Y36(m.g))},f.\u0275cmp=t.Xpm({type:f,selectors:[["app-dash-card-detail"]],decls:10,vars:3,consts:[["slot","start"],["defaultHref","/"],["slot","end"],["routerLink","settings",4,"ngIf"],[3,"card","title",4,"ngIf"],["routerLink","settings"],["name","options-outline"],[3,"card","title"]],template:function(n,e){1&n&&(t.TgZ(0,"ion-header"),t.TgZ(1,"ion-toolbar"),t.TgZ(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.qZA(),t.TgZ(6,"ion-buttons",2),t.YNc(7,Q,2,0,"ion-button",3),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"ion-content"),t.YNc(9,R,1,1,"app-card-detail-content",4),t.qZA()),2&n&&(t.xp6(5),t.Oqu(e.cardTitle||(null==e.cardType||null==e.cardType.title?null:e.cardType.title.cs)||"Detail karty"),t.xp6(2),t.Q6J("ngIf",null==e.cardType?null:e.cardType.settingsComponent),t.xp6(2),t.Q6J("ngIf",e.card))},directives:[r.Gu,r.sr,r.Sm,r.oU,r.cs,r.wd,g.O5,r.W2,r.YG,h.rH,r.YI,r.gu,N],styles:[""]}),f=(0,y.gn)([(0,_.c)()],f);let H=(()=>{class i{constructor(e,o){this.componentFactoryResolver=e,this.viewContainerRef=o,this.select=new t.vpe,this.buttons=new t.vpe}ngOnInit(){}ngOnChanges(){this.removeOldComponent(),this.cardType&&this.renderComponent(this.cardType)}renderComponent(e){var o,a;if(!(null===(o=this.cardType)||void 0===o?void 0:o.selectComponent))return;const s=this.componentFactoryResolver.resolveComponentFactory(e.selectComponent),c=this.viewContainerRef.createComponent(s);this.selectSubscription=c.instance.select.subscribe(d=>this.select.emit(d)),this.buttonsSubscription=null===(a=c.instance.buttons)||void 0===a?void 0:a.subscribe(d=>this.buttons.emit(d))}removeOldComponent(){var e,o;null===(e=this.selectSubscription)||void 0===e||e.unsubscribe(),null===(o=this.buttonsSubscription)||void 0===o||o.unsubscribe(),this.viewContainerRef.clear()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t._Vd),t.Y36(t.s_b))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-card-selection-content"]],inputs:{cardType:"cardType"},outputs:{select:"select",buttons:"buttons"},features:[t.TTD],decls:0,vars:0,template:function(e,o){},styles:[""]}),i})();function $(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",6),t.NdJ("click",function(){return t.CHM(e).$implicit.handler()}),t._UZ(1,"ion-icon",7),t.qZA()}if(2&i){const e=n.$implicit;t.xp6(1),t.Q6J("name",e.icon)}}function z(i,n){if(1&i&&(t.TgZ(0,"ion-buttons",4),t.YNc(1,$,2,1,"ion-button",5),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.buttons)}}let v=class{constructor(n,e,o,a){this.route=n,this.dashboardService=e,this.navController=o,this.cards=a}ngOnInit(){}ionViewWillEnter(){this.route.params.pipe((0,_.t)(this)).subscribe(n=>{this.buttons=void 0,this.cardType=this.cards.find(e=>e.type===n.type)})}createCard(n){var e=this;return(0,p.Z)(function*(){!e.cardType||(yield e.dashboardService.createCard(e.route.snapshot.params.page,e.cardType.type,n),e.navController.navigateRoot("/dash",{queryParams:{page:e.route.snapshot.params.page}}))})()}};v.\u0275fac=function(n){return new(n||v)(t.Y36(h.gz),t.Y36(C),t.Y36(r.SH),t.Y36(m.g))},v.\u0275cmp=t.Xpm({type:v,selectors:[["app-dash-card-selection"]],decls:9,vars:3,consts:[["slot","start"],["defaultHref","/dash/add"],["slot","end",4,"ngIf"],[3,"cardType","buttons","select"],["slot","end"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[3,"name"]],template:function(n,e){1&n&&(t.TgZ(0,"ion-header"),t.TgZ(1,"ion-toolbar"),t.TgZ(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.qZA(),t.YNc(6,z,2,1,"ion-buttons",2),t.qZA(),t.qZA(),t.TgZ(7,"ion-content"),t.TgZ(8,"app-card-selection-content",3),t.NdJ("buttons",function(a){return e.buttons=a})("select",function(a){return e.createCard(a)}),t.qZA(),t.qZA()),2&n&&(t.xp6(5),t.Oqu(null==e.cardType||null==e.cardType.title?null:e.cardType.title.cs),t.xp6(1),t.Q6J("ngIf",e.buttons),t.xp6(2),t.Q6J("cardType",e.cardType))},directives:[r.Gu,r.sr,r.Sm,r.oU,r.cs,r.wd,g.O5,r.W2,H,g.sg,r.YG,r.gu],styles:[""]}),v=(0,y.gn)([(0,_.c)()],v);let B=(()=>{class i{constructor(e,o,a){this.componentFactoryResolver=e,this.viewContainerRef=o,this.cards=a,this.change=new t.vpe}ngOnInit(){}ngOnChanges(){this.renderCard(this.card)}renderCard(e){var o;const a=this.cards.find(d=>d.type===e.type);if(!a||!a.settingsComponent)return;this.viewContainerRef.clear(),null===(o=this.changeSubscription)||void 0===o||o.unsubscribe();const s=this.componentFactoryResolver.resolveComponentFactory(a.settingsComponent),c=this.viewContainerRef.createComponent(s);c.instance.card=e,this.changeSubscription=c.instance.change.subscribe(d=>this.change.emit(d))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t._Vd),t.Y36(t.s_b),t.Y36(m.g))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-card-custom-settings"]],inputs:{card:"card"},outputs:{change:"change"},features:[t.TTD],decls:0,vars:0,template:function(e,o){},styles:[""]}),i})();var A=l(4182);function G(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"app-card-custom-settings",5),t.NdJ("change",function(a){return t.CHM(e),t.oxw(2).saveCustom(a)}),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("card",e.card)}}function X(i,n){if(1&i&&(t.ynx(0),t.TgZ(1,"ion-list-header"),t.TgZ(2,"ion-label"),t.TgZ(3,"h1"),t._uU(4),t.qZA(),t.qZA(),t.qZA(),t.YNc(5,G,1,1,"app-card-custom-settings",4),t.BQk()),2&i){const e=t.oxw();t.xp6(4),t.Oqu(e.cardType.title.cs),t.xp6(1),t.Q6J("ngIf",e.card&&e.cardType&&e.cardType.settingsComponent)}}function V(i,n){if(1&i&&(t.TgZ(0,"ion-select-option",12),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.title)}}function W(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item-group"),t.TgZ(1,"ion-item"),t.TgZ(2,"ion-label"),t._uU(3,"Str\xe1nka"),t.qZA(),t.TgZ(4,"ion-select",6),t.NdJ("ngModelChange",function(a){return t.CHM(e),t.oxw().changePage(a)}),t.YNc(5,V,2,2,"ion-select-option",7),t.qZA(),t.qZA(),t.TgZ(6,"ion-item"),t.TgZ(7,"ion-label"),t._uU(8,"N\xe1zev karty"),t.qZA(),t.TgZ(9,"ion-input",6),t.NdJ("ngModelChange",function(a){return t.CHM(e),t.oxw().card.title=a})("ngModelChange",function(){return t.CHM(e),t.oxw().save()}),t.qZA(),t.qZA(),t.TgZ(10,"ion-item"),t.TgZ(11,"ion-label"),t._uU(12,"Barva"),t.qZA(),t.TgZ(13,"ion-select",6),t.NdJ("ngModelChange",function(a){return t.CHM(e),t.oxw().card.color=a})("ngModelChange",function(){return t.CHM(e),t.oxw().save()}),t.TgZ(14,"ion-select-option",8),t._uU(15,"B\xedl\xe1"),t.qZA(),t.TgZ(16,"ion-select-option",9),t._uU(17,"\u010cern\xe1"),t.qZA(),t.TgZ(18,"ion-select-option",10),t._uU(19,"R\u016f\u017eov\xe1"),t.qZA(),t.TgZ(20,"ion-select-option",11),t._uU(21,"Modr\xe1"),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&i){const e=t.oxw();t.xp6(4),t.Q6J("ngModel",null==e.cardPage?null:e.cardPage.id),t.xp6(1),t.Q6J("ngForOf",e.pages),t.xp6(4),t.Q6J("ngModel",e.card.title),t.xp6(4),t.Q6J("ngModel",e.card.color)}}function j(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",13),t.TgZ(1,"ion-button",14),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return a.deleteCard(a.card.id)}),t._uU(2,"Smazat kartu"),t.qZA(),t.qZA()}}let Z=class{constructor(n,e,o,a){this.route=n,this.navController=e,this.dashboardService=o,this.cards=a}ngOnInit(){}ionViewWillEnter(){this.route.params.pipe((0,_.t)(this)).subscribe(n=>this.loadCard(n.id))}loadCard(n){var e=this;return(0,p.Z)(function*(){const o=yield e.dashboardService.getDashboard();e.pages=o.pages,e.card=yield e.dashboardService.getCard(n),e.cardPage=o.pages.find(a=>a.cards.some(s=>{var c;return s.id===(null===(c=e.card)||void 0===c?void 0:c.id)})),e.cardType=e.cards.find(a=>{var s;return a.type===(null===(s=e.card)||void 0===s?void 0:s.type)})})()}deleteCard(n){var e=this;return(0,p.Z)(function*(){yield e.dashboardService.removeCard(n),e.navController.navigateRoot("/")})()}save(){var n=this;return(0,p.Z)(function*(){!n.card||n.dashboardService.updateCard(n.card)})()}saveCustom(n){var e=this;return(0,p.Z)(function*(){!e.card||(e.card.definition=n,e.save())})()}changePage(n){var e=this;return(0,p.Z)(function*(){const o=yield e.dashboardService.getDashboard(),a=o.pages.find(d=>d.cards.some(u=>{var D;return u.id===(null===(D=e.card)||void 0===D?void 0:D.id)})),s=o.pages.find(d=>d.id===n);if(console.log(a,s),!a||!s)return;const c=a.cards.findIndex(d=>{var u;return d.id===(null===(u=e.card)||void 0===u?void 0:u.id)});null==s||s.cards.push(...a.cards.splice(c,1)),e.dashboardService.saveDashboard(o)})()}};Z.\u0275fac=function(n){return new(n||Z)(t.Y36(h.gz),t.Y36(r.SH),t.Y36(C),t.Y36(m.g))},Z.\u0275cmp=t.Xpm({type:Z,selectors:[["app-dash-card-settings"]],decls:18,vars:4,consts:[["slot","start"],["defaultHref","/"],[4,"ngIf"],["class","actions ion-padding",4,"ngIf"],[3,"card","change",4,"ngIf"],[3,"card","change"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["value","white"],["value","black"],["value","pink"],["value","blue"],[3,"value"],[1,"actions","ion-padding"],["color","danger",3,"click"]],template:function(n,e){1&n&&(t.TgZ(0,"ion-header"),t.TgZ(1,"ion-toolbar"),t.TgZ(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.qZA(),t.qZA(),t.qZA(),t.TgZ(6,"ion-content"),t.YNc(7,X,6,2,"ng-container",2),t.TgZ(8,"ion-list-header"),t.TgZ(9,"ion-label"),t.TgZ(10,"h1"),t._uU(11,"Obecn\xe1 nastaven\xed"),t.qZA(),t.qZA(),t.qZA(),t.YNc(12,W,22,4,"ion-item-group",2),t.TgZ(13,"ion-list-header"),t.TgZ(14,"ion-label"),t.TgZ(15,"h1"),t._uU(16,"Smazat kartu"),t.qZA(),t.qZA(),t.qZA(),t.YNc(17,j,3,0,"div",3),t.qZA()),2&n&&(t.xp6(5),t.Oqu((null==e.card?null:e.card.title)||"Nastaven\xed karty"),t.xp6(2),t.Q6J("ngIf",e.card&&e.cardType&&e.cardType.settingsComponent),t.xp6(5),t.Q6J("ngIf",e.card),t.xp6(5),t.Q6J("ngIf",e.card))},directives:[r.Gu,r.sr,r.Sm,r.oU,r.cs,r.wd,r.W2,g.O5,r.yh,r.Q$,B,r.Ub,r.Ie,r.t9,r.QI,A.JJ,A.On,g.sg,r.pK,r.j9,r.n0,r.YG],styles:["ion-list-header[_ngcontent-%COMP%]{margin-top:2em}.actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%}"]}),Z=(0,y.gn)([(0,_.c)()],Z);var P=l(3426),L=l(2055);function K(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",7),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return a.sortCards=!a.sortCards}),t._uU(1,"Se\u0159adit"),t.qZA()}}function tt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",7),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return a.sortCards=!a.sortCards}),t._uU(1,"Hotovo"),t.qZA()}}function et(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",8),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).onCardClick(s)}),t.TgZ(1,"ion-label"),t.TgZ(2,"h2"),t._uU(3),t.qZA(),t.TgZ(4,"p"),t._uU(5),t.qZA(),t.qZA(),t._UZ(6,"ion-reorder",9),t.qZA()}if(2&i){const e=n.$implicit,o=t.oxw(2);t.Q6J("detail",!o.sortCards),t.xp6(3),t.Oqu(e.title),t.xp6(2),t.Oqu(o.getCardTypeTitle(e))}}function nt(i,n){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"ion-item",3),t.TgZ(2,"ion-label"),t.TgZ(3,"h1"),t._uU(4,"Karty"),t.qZA(),t.qZA(),t.YNc(5,K,2,0,"ion-button",4),t.YNc(6,tt,2,0,"ion-button",4),t.qZA(),t.TgZ(7,"ion-reorder-group",5),t.NdJ("ionItemReorder",function(a){return t.CHM(e),t.oxw().onReorder(a)}),t.YNc(8,et,7,3,"ion-item",6),t.qZA(),t.BQk()}if(2&i){const e=t.oxw();t.xp6(5),t.Q6J("ngIf",!e.sortCards),t.xp6(1),t.Q6J("ngIf",e.sortCards),t.xp6(1),t.Q6J("disabled",!e.sortCards),t.xp6(1),t.Q6J("ngForOf",e.page.cards)}}function ot(i,n){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"ion-item",3),t.TgZ(2,"ion-label"),t.TgZ(3,"h1"),t._uU(4,"Obecn\xe9"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(5,"ion-item"),t.TgZ(6,"ion-label"),t._uU(7,"N\xe1zev"),t.qZA(),t.TgZ(8,"ion-input",10),t.NdJ("ngModelChange",function(a){return t.CHM(e),t.oxw().page.title=a})("ngModelChange",function(){return t.CHM(e),t.oxw().save()}),t.qZA(),t.qZA(),t.TgZ(9,"ion-item",3),t.TgZ(10,"ion-label"),t.TgZ(11,"h1"),t._uU(12,"Smazat str\xe1nku"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"div",11),t.TgZ(14,"ion-button",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().deletePage()}),t._uU(15,"Smazat str\xe1nku"),t.qZA(),t.qZA(),t.BQk()}if(2&i){const e=t.oxw();t.xp6(8),t.Q6J("ngModel",e.page.title)}}let b=class{constructor(n,e,o,a,s,c){this.dashboardService=n,this.route=e,this.navController=o,this.alertController=a,this.cardTypes=s,this.settings=c,this.sortCards=!1}ngOnInit(){const n=this.dashboardService.dashboard.pipe((0,_.t)(this)),e=this.route.params.pipe((0,_.t)(this));(0,P.aj)([n,e]).subscribe(([o,a])=>{this.dashboard=o,this.page=null==o?void 0:o.pages.find(s=>s.id===a.page)})}onReorder(n){var e;!this.dashboard||!this.page||(this.page.cards.splice(n.detail.to,0,...null===(e=this.page)||void 0===e?void 0:e.cards.splice(n.detail.from,1)),this.dashboardService.saveDashboard(this.dashboard),n.detail.complete(!0))}onCardClick(n){this.sortCards||this.navController.navigateForward(`/card/${n.id}/settings`)}save(){if(this.dashboard)return this.dashboardService.saveDashboard(this.dashboard)}deletePage(){var n=this;return(0,p.Z)(function*(){(yield n.alertController.create({header:"Smazat str\xe1nku",message:"Pozor: sma\u017eete i v\u0161echny karty na str\xe1nce!",buttons:[{text:"Zru\u0161it",role:"cancel"},{text:"Smazat",handler:()=>n.deletePageConfirmed()}]})).present()})()}deletePageConfirmed(){var n=this;return(0,p.Z)(function*(){!n.dashboard||!n.page||(n.dashboard.pages.splice(n.dashboard.pages.findIndex(e=>e.id===n.page.id),1),yield n.save(),n.navController.navigateRoot("/"))})()}getCardTypeTitle(n){const e=this.cardTypes.find(o=>o.type===n.type);return null==e?void 0:e.title[this.settings.lang]}};function it(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",9),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return a.sortPages=!a.sortPages}),t._uU(1,"Se\u0159adit"),t.qZA()}}function at(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",9),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return a.sortPages=!a.sortPages}),t._uU(1,"Hotovo"),t.qZA()}}function rt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item",10),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw().onPageClick(s)}),t.TgZ(1,"ion-label"),t.TgZ(2,"h2"),t._uU(3),t.qZA(),t.TgZ(4,"p"),t._uU(5),t.qZA(),t.qZA(),t._UZ(6,"ion-reorder",11),t.qZA()}if(2&i){const e=n.$implicit,o=t.oxw();t.Q6J("detail",!o.sortPages),t.xp6(3),t.Oqu(e.title),t.xp6(2),t.hij("Po\u010det karet: ",e.cards.length,"")}}b.\u0275fac=function(n){return new(n||b)(t.Y36(C),t.Y36(h.gz),t.Y36(r.SH),t.Y36(r.Br),t.Y36(m.g),t.Y36(L.g))},b.\u0275cmp=t.Xpm({type:b,selectors:[["app-dash-edit-page"]],decls:9,vars:3,consts:[["slot","start"],["defaultHref","/"],[4,"ngIf"],["lines","none",1,"title"],["slot","end","fill","clear",3,"click",4,"ngIf"],[3,"disabled","ionItemReorder"],[3,"detail","click",4,"ngFor","ngForOf"],["slot","end","fill","clear",3,"click"],[3,"detail","click"],["slot","end"],[3,"ngModel","ngModelChange"],[1,"actions","ion-padding"],["color","danger",3,"click"]],template:function(n,e){1&n&&(t.TgZ(0,"ion-header"),t.TgZ(1,"ion-toolbar"),t.TgZ(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.qZA(),t.qZA(),t.qZA(),t.TgZ(6,"ion-content"),t.YNc(7,nt,9,4,"ng-container",2),t.YNc(8,ot,16,1,"ng-container",2),t.qZA()),2&n&&(t.xp6(5),t.Oqu((null==e.page?null:e.page.title)||"Upravit str\xe1nku"),t.xp6(2),t.Q6J("ngIf",null==e.page?null:e.page.cards),t.xp6(1),t.Q6J("ngIf",e.page))},directives:[r.Gu,r.sr,r.Sm,r.oU,r.cs,r.wd,r.W2,g.O5,r.Ie,r.Q$,r.oz,g.sg,r.YG,r.Nh,r.pK,r.j9,A.JJ,A.On],styles:[".title[_ngcontent-%COMP%]{margin-top:2em}.actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%}"]}),b=(0,y.gn)([(0,_.c)()],b);let T=class{constructor(n,e){this.dashboardService=n,this.navController=e,this.sortPages=!1}ngOnInit(){this.dashboardService.dashboard.pipe((0,_.t)(this)).subscribe(n=>this.dashboard=n)}onReorder(n){var e;!this.dashboard||(this.dashboard.pages.splice(n.detail.to,0,...null===(e=this.dashboard)||void 0===e?void 0:e.pages.splice(n.detail.from,1)),this.dashboardService.saveDashboard(this.dashboard),n.detail.complete(!0))}onPageClick(n){this.sortPages||this.navController.navigateForward(`/page/${n.id}/edit`)}};T.\u0275fac=function(n){return new(n||T)(t.Y36(C),t.Y36(r.SH))},T.\u0275cmp=t.Xpm({type:T,selectors:[["app-dash-edit"]],decls:18,vars:4,consts:[["slot","start"],["defaultHref","/"],["slot","primary"],["routerLink","/settings"],["name","settings-outline"],["lines","none",1,"title"],["slot","end","fill","clear",3,"click",4,"ngIf"],[3,"disabled","ionItemReorder"],[3,"detail","click",4,"ngFor","ngForOf"],["slot","end","fill","clear",3,"click"],[3,"detail","click"],["slot","end"]],template:function(n,e){1&n&&(t.TgZ(0,"ion-header"),t.TgZ(1,"ion-toolbar"),t.TgZ(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5,"Upravit n\xe1st\u011bnku"),t.qZA(),t.TgZ(6,"ion-buttons",2),t.TgZ(7,"ion-button",3),t._UZ(8,"ion-icon",4),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"ion-content"),t.TgZ(10,"ion-item",5),t.TgZ(11,"ion-label"),t.TgZ(12,"h1"),t._uU(13,"Str\xe1nky"),t.qZA(),t.qZA(),t.YNc(14,it,2,0,"ion-button",6),t.YNc(15,at,2,0,"ion-button",6),t.qZA(),t.TgZ(16,"ion-reorder-group",7),t.NdJ("ionItemReorder",function(a){return e.onReorder(a)}),t.YNc(17,rt,7,3,"ion-item",8),t.qZA(),t.qZA()),2&n&&(t.xp6(14),t.Q6J("ngIf",!e.sortPages),t.xp6(1),t.Q6J("ngIf",e.sortPages),t.xp6(1),t.Q6J("disabled",!e.sortPages),t.xp6(1),t.Q6J("ngForOf",null==e.dashboard?null:e.dashboard.pages))},directives:[r.Gu,r.sr,r.Sm,r.oU,r.cs,r.wd,r.YG,h.rH,r.YI,r.gu,r.W2,r.Ie,r.Q$,g.O5,r.oz,g.sg,r.Nh],styles:[".title[_ngcontent-%COMP%]{margin-top:2em}.actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%}"]}),T=(0,y.gn)([(0,_.c)()],T);const ct=(0,l(7423).fo)("App",{web:()=>l.e(4477).then(l.bind(l,4477)).then(i=>new i.AppWeb)});var M=l(2198),O=l(3544),k=l(2670);let dt=(()=>{class i{constructor(e,o,a){this.componentFactoryResolver=e,this.viewContainerRef=o,this.cards=a}ngOnInit(){}ngOnChanges(){this.renderCard(this.card)}renderCard(e){const o=this.cards.find(c=>c.type===e.type);if(!o)return;this.viewContainerRef.clear();const a=this.componentFactoryResolver.resolveComponentFactory(o.component);this.viewContainerRef.createComponent(a).instance.card=e}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t._Vd),t.Y36(t.s_b),t.Y36(m.g))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-card-content"]],inputs:{card:"card"},features:[t.TTD],decls:0,vars:0,template:function(e,o){},styles:[""],changeDetection:0}),i})(),lt=(()=>{class i{constructor(){this.classes={}}ngOnInit(){}ngOnChanges(){this.classes={},this.card.color&&(this.classes["color-"+this.card.color]=!0)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-dash-card"]],inputs:{card:"card"},features:[t.TTD],decls:2,vars:2,consts:[["mode","ios",3,"ngClass"],[3,"card"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-card",0),t._UZ(1,"app-card-content",1),t.qZA()),2&e&&(t.Q6J("ngClass",o.classes),t.xp6(1),t.Q6J("card",o.card))},directives:[r.PM,g.mk,dt],styles:["[_nghost-%COMP%]{display:block}ion-card[_ngcontent-%COMP%]{margin:0}@supports ((-webkit-backdrop-filter: none) or (backdrop-filter: none)){ion-card[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background-color:#ffffffb3}}ion-card.color-pink[_ngcontent-%COMP%]{background-color:#f8607cb3;color:#111}ion-card.color-black[_ngcontent-%COMP%]{background-color:#000000b3;color:#eee}ion-card.color-black[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#ddd}ion-card.color-blue[_ngcontent-%COMP%]{background-color:#1889f3b3;color:#eee}ion-card.color-blue[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#ddd}"]}),i})();function pt(i,n){if(1&i&&(t.TgZ(0,"ion-item",12),t.TgZ(1,"ion-label"),t._uU(2,"P\u0159idat kartu"),t.qZA(),t._UZ(3,"ion-icon",4),t.qZA()),2&i){const e=t.oxw(2);t.Q6J("routerLink","/page/"+e.currentPage.id+"/add")("button",!0)("detail",!1)}}function ut(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"ion-content"),t.TgZ(1,"ion-list"),t.YNc(2,pt,4,3,"ion-item",9),t.TgZ(3,"ion-item",10),t.NdJ("click",function(){return t.CHM(e),t.oxw().addPage()}),t.TgZ(4,"ion-label"),t._uU(5,"P\u0159idat str\xe1nku"),t.qZA(),t._UZ(6,"ion-icon",11),t.qZA(),t.qZA(),t.qZA()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.currentPage),t.xp6(1),t.Q6J("button",!0)("detail",!1)}}function gt(i,n){if(1&i&&(t.TgZ(0,"div",21),t._uU(1),t.qZA()),2&i){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.title||"Hlavn\xed"," ")}}function _t(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"app-dash-card",22),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(4).openDetail(s)}),t.qZA()}2&i&&t.Q6J("card",n.$implicit)}function ht(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",17),t.YNc(1,gt,2,1,"div",18),t.TgZ(2,"div",19),t.NdJ("scroll",function(){return t.CHM(e),t.oxw(3).onCardsScroll()}),t.YNc(3,_t,1,1,"app-dash-card",20),t.qZA(),t.qZA()}if(2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",o.dashboard.pages.length>1),t.xp6(2),t.Q6J("ngForOf",e.cards)}}function mt(i,n){1&i&&t.YNc(0,ht,4,2,"ng-template",16)}function Ct(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"ion-content"),t.TgZ(1,"ion-refresher",13),t.NdJ("ionRefresh",function(a){t.CHM(e);const s=t.oxw();return s.doRefresh(a,s.currentPage)}),t._UZ(2,"ion-refresher-content"),t.qZA(),t.TgZ(3,"swiper",14),t.NdJ("swiper",function(a){return t.CHM(e),t.oxw().swiper.next(a)})("observerUpdate",function(){return t.CHM(e),t.oxw().updateState()})("activeIndexChange",function(){return t.CHM(e),t.oxw().updateState()}),t.YNc(4,mt,1,0,void 0,15),t.qZA(),t.qZA()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("disabled",!e.enableRefresh),t.xp6(2),t.Q6J("config",e.swiperConfig),t.xp6(1),t.Q6J("ngForOf",e.dashboard.pages)}}O.ZP.use([O.VS]);let x=class{constructor(n,e,o,a,s,c,d,u){this.dashboardService=n,this.cardTypes=e,this.navController=o,this.alertController=a,this.route=s,this.router=c,this.platform=d,this.ngZone=u,this.swiper=new S.X(void 0),this.swiperConfig={parallax:!0,slidesPerView:1,spaceBetween:0,navigation:!1},this.enableRefresh=!0}ngOnInit(){const n=this.dashboardService.dashboard.pipe((0,_.t)(this));n.subscribe(a=>this.dashboard=a);const e=this.route.queryParams.pipe((0,_.t)(this)),o=this.swiper.pipe((0,M.h)(a=>!!a));(0,P.aj)([n,e,o]).pipe((0,M.h)(a=>!!a[0])).subscribe(([a,s])=>{var c,d;const u=s.page||(null===(c=a.pages[0])||void 0===c?void 0:c.id);u!==(null===(d=this.currentPage)||void 0===d?void 0:d.id)&&this.openPage(u,!0)})}ionViewDidEnter(){var n=this;this.backButtonSubscription=this.platform.backButton.subscribeWithPriority(-1,(0,p.Z)(function*(){n.route.snapshot.params.page?n.navController.navigateRoot("/"):ct.exitApp()}))}ionViewWillLeave(){var n;null===(n=this.backButtonSubscription)||void 0===n||n.unsubscribe()}getCurrentCardsEl(){var n,e;return null===(e=null===(n=this.swiper.value)||void 0===n?void 0:n.slides[this.swiper.value.activeIndex])||void 0===e?void 0:e.querySelector(".cards")}openPage(n,e=!1){if(!this.dashboard||!this.swiper.value)return;const o=this.dashboard.pages.findIndex(a=>a.id===n);this.swiper.value.activeIndex!==o&&this.swiper.value.slideTo(o,e?0:void 0)}updateState(){if(!this.dashboard||!this.swiper.value)return;const e=this.dashboard.pages[this.swiper.value.activeIndex];this.ngZone.run(()=>{var o;e.id!==(null===(o=this.currentPage)||void 0===o?void 0:o.id)&&(this.currentPage=e);const a=this.getCurrentCardsEl();a&&(this.enableRefresh=0===a.scrollTop),this.route.snapshot.params.page!==e.id&&this.router.navigate([],{queryParams:{page:e.id},replaceUrl:!0})})}onCardsScroll(){var n;this.enableRefresh=0===(null===(n=this.getCurrentCardsEl())||void 0===n?void 0:n.scrollTop)}doRefresh(n,e){e.cards=JSON.parse(JSON.stringify(e.cards)),setTimeout(()=>{var o;null===(o=n.target)||void 0===o||o.complete()},500)}openDetail(n){const e=this.cardTypes.find(o=>o.type===n.type);!e||this.navController.navigateForward(e.detailComponent?"/card/"+n.id:"/card/"+n.id+"/settings")}addPage(){var n=this;return(0,p.Z)(function*(){yield(yield n.alertController.create({header:"Nov\xe1 str\xe1nka",message:"Vytvo\u0159\xed novou str\xe1nku pro va\u0161e karty.",inputs:[{name:"title",type:"text",placeholder:"N\xe1zev str\xe1nky"}],buttons:[{text:"Zru\u0161it",role:"cancel",cssClass:"secondary"},{text:"Vytvo\u0159it",handler:o=>!!o.title&&(n.addPageConfirmed(o),!0)}]})).present()})()}addPageConfirmed(n){var e=this;return(0,p.Z)(function*(){const o=n.title||void 0,a=yield e.dashboardService.createPage(o);setTimeout(()=>e.openPage(a.id),500)})()}};x.\u0275fac=function(n){return new(n||x)(t.Y36(C),t.Y36(m.g),t.Y36(r.SH),t.Y36(r.Br),t.Y36(h.gz),t.Y36(h.F0),t.Y36(r.t4),t.Y36(t.R0b))},x.\u0275cmp=t.Xpm({type:x,selectors:[["app-dash"]],decls:12,vars:2,consts:[[1,"ion-no-border"],["color","light","mode","md"],["slot","primary"],["id","add-button","color","light"],["name","add-outline"],["trigger","add-button",3,"dismissOnSelect"],["color","light","routerLink","/dash/edit"],["name","options-outline"],[4,"ngIf"],[3,"routerLink","button","detail",4,"ngIf"],[3,"button","detail","click"],["name","reader-outline"],[3,"routerLink","button","detail"],["slot","fixed",3,"disabled","ionRefresh"],[3,"config","swiper","observerUpdate","activeIndexChange"],[4,"ngFor","ngForOf"],["swiperSlide",""],[1,"page"],["class","title","data-swiper-parallax","70%","data-swiper-parallax-opacity","0",4,"ngIf"],[1,"cards",3,"scroll"],[3,"card","click",4,"ngFor","ngForOf"],["data-swiper-parallax","70%","data-swiper-parallax-opacity","0",1,"title"],[3,"card","click"]],template:function(n,e){1&n&&(t.TgZ(0,"ion-header",0),t.TgZ(1,"ion-toolbar"),t.TgZ(2,"ion-title",1),t._uU(3," PragueDash "),t.qZA(),t.TgZ(4,"ion-buttons",2),t.TgZ(5,"ion-button",3),t._UZ(6,"ion-icon",4),t.qZA(),t.TgZ(7,"ion-popover",5),t.YNc(8,ut,7,3,"ng-template"),t.qZA(),t.TgZ(9,"ion-button",6),t._UZ(10,"ion-icon",7),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(11,Ct,5,3,"ion-content",8)),2&n&&(t.xp6(7),t.Q6J("dismissOnSelect",!0),t.xp6(4),t.Q6J("ngIf",e.dashboard))},directives:[r.Gu,r.sr,r.wd,r.Sm,r.YG,r.gu,r.d8,h.rH,r.YI,g.O5,r.W2,r.q_,r.Ie,r.Q$,r.nJ,r.Wo,k.nF,g.sg,k.YC,lt],styles:["[_nghost-%COMP%]{background-image:url(/demo/bg.44f0e10025ebec95.jpg);background-size:cover;background-position:center}  .swiper{height:100%}  .swiper-slide{display:block!important;height:100%}ion-content[_ngcontent-%COMP%], ion-toolbar[_ngcontent-%COMP%]{--background: transparent}ion-slides[_ngcontent-%COMP%]{height:100%}ion-slide[_ngcontent-%COMP%]{flex-direction:column;justify-content:flex-start;text-align:left}.page[_ngcontent-%COMP%]{position:relative;text-align:left;display:flex;flex-direction:column;height:100%}.page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{text-align:center;font-size:.8em;color:#eee;padding:0 16px}.page[_ngcontent-%COMP%]   .cards[_ngcontent-%COMP%]{overflow:auto;margin-top:24px;padding:0 16px}.page[_ngcontent-%COMP%]   .cards[_ngcontent-%COMP%]   app-dash-card[_ngcontent-%COMP%]{margin-bottom:24px}"]}),x=(0,y.gn)([(0,_.c)()],x);const ft=[{path:"dash/edit",component:T},{path:"dash",component:x},{path:"page/:page/edit",component:b},{path:"page/:page/add",component:U},{path:"page/:page/add/:type",component:v},{path:"card/:id",component:f},{path:"card/:id/settings",component:Z},{path:"",pathMatch:"full",redirectTo:"dash"}];let vt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[h.Bz.forChild(ft)],h.Bz]}),i})(),Zt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[g.ez,vt,J.m,F.m]]}),i})()}}]);